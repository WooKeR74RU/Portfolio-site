<!DOCTYPE html>
<head>
    <meta charset="utf-8"/>
    <title>⚜ More than words, less than wisdom ⚜</title>
    <meta property="og:title" content="⚜ More than words, less than wisdom ⚜">
</head>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css">
<link href="../public/css/bootstrap.min.css" rel="stylesheet">
<link href="../public/css/mdb.min.css" rel="stylesheet">
<script type="text/javascript" src="../public/build/bundle.js"></script>

<html lang="ru">


<body style="max-height: 100vh" class="animated fadeIn fast">

{% block navBar %}
    {% include './navBar.twig' %}
{% endblock %}

<div style="height: 80vh;display: block" class="">

    <div id="quoteContainer" style="width: 100%;height: 70%;display:flex; justify-content: center;padding: 13%;"
         class="quoteContainer">
        <div style="font-size: 2em; transform: translate(0,-50%);height: max-content;top: 50%;position: relative;text-align: center;">
            <div id="phraseContainer"></div>

            <footer id="authorContainer" class="blockquote-footer mb-3" style="margin-top: 10px"></footer>
        </div>

    </div>

    <div style="display: flex;justify-content: center;max-height: 30%;">
        <button type="button" class="btn" style="" onclick="setPhrase()">
            <i class="fas fa-sync-alt" style="font-size: 6.5em;"></i></button>
    </div>
</div>
<div style="height: 10vh">
    <div class="" style="border-top:1px solid #e6e6e6; position: absolute;bottom: 0; width: 100%"></div>

    {% block footer %}
        {% include  '.\footer.twig' with {hostname: hostname} %}
    {% endblock %}
</div>


<script type="text/javascript" src="../public/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../public/js/popper.min.js"></script>
<script type="text/javascript" src="../public/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../public/js/mdb.min.js"></script>

<script>
    new WOW().init()
</script>


<script>
    let phraseContainer = document.getElementById("phraseContainer")
    let authorContainer = document.getElementById("authorContainer")
    let quoteContainer = document.getElementById("quoteContainer")

    let res = {};
    var current = -1;

    async function StartInit() {
        res = (await getJSON('{{ hostname }}' + '/public/wisdomPageContent.json'))['phrases'];
        setPhrase()
    }

    let setPhrase = function () {
        if (current == -1) {
            current = randNum(res, current);
            phraseContainer.innerHTML = res[current]['phrase'];
            authorContainer.innerHTML = res[current]['author'];
            return
        }
        current = randNum(res, current);

        quoteContainer.classList.add('fadeOut');
        quoteContainer.classList.remove('fadeIn');

        window.setTimeout(function () {
            phraseContainer.innerHTML = res[current]['phrase'];
            authorContainer.innerHTML = res[current]['author'];
            quoteContainer.classList.remove('fadeOut');
            quoteContainer.classList.add('fadeIn');
        }, 400)

    };

    function randNum(arr, excludeNum) {
        console.log("HGFghj")
        let randNumber = Math.floor(Math.random() * arr.length);
        if (randNumber === excludeNum) {
            return randNum(arr, excludeNum);
        } else {
            return randNumber;
        }
    }

    let getJSON = function (url) {
        return new Promise(function (resolve, reject) {
            let xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.responseType = 'json';

            xhr.onload = function () {
                if (xhr.status === 200) {
                    resolve(xhr.response);
                } else {
                    reject({
                        status: this.status,
                        statusText: xhr.statusText
                    });
                }
            };

            xhr.onerror = function () {
                reject({
                    status: this.status,
                    statusText: xhr.statusText
                });
            };
            xhr.send();
        });
    };

    StartInit();

</script>

<style>
    .quoteContainer {
        opacity: 1;
        transition: opacity 0.4s;
    }

    .fadeOut {
        opacity: 0;
    }

    .fadeIn {
        opacity: 1;
    }

    .btn:hover {
        background: #f5f5f5 !important;
    }

    .btn {
        background: transparent !important;
        color: #000 !important;
        box-shadow: none !important;
    }
</style>

</body>
</html>